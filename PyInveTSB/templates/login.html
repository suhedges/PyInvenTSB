{% extends "base.html" %}
{% block content %}

<!-- Auth background accents (purely decorative) -->
<div class="auth-bg">
  <div class="auth-orb orb-1"></div>
  <div class="auth-orb orb-2"></div>
  <div class="auth-noise"></div>
</div>

<section class="auth-container">
  <div class="card auth-card narrow">
    <header class="auth-header">
      <div class="auth-icon">
        <!-- lock icon -->
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M7 10V8a5 5 0 1 1 10 0v2" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          <rect x="4.75" y="10" width="14.5" height="10.5" rx="2.25" stroke="currentColor" stroke-width="1.6"/>
          <circle cx="12" cy="15.75" r="1.25" fill="currentColor"/>
        </svg>
      </div>
      <h1 class="auth-title">Sign in</h1>
      <p class="auth-sub">Enter your 3-letter username to continue.</p>
    </header>

    <form method="post" class="stack auth-form" id="loginForm" novalidate>
      <label for="username" class="auth-label">Username (3 letters)</label>

      <div class="field has-icon">
        <span class="field-icon" aria-hidden="true">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="8" r="4" stroke="currentColor" stroke-width="1.6"/>
            <path d="M5 19.5c1.6-3.2 5-4.5 7-4.5s5.4 1.3 7 4.5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          </svg>
        </span>
        <input
          id="username"
          name="username"
          class="input-lg"
          maxlength="3"
          minlength="3"
          placeholder="ABC"
          inputmode="latin"
          pattern="[A-Za-z]{3}"
          autocomplete="username"
          oninput="this.value=this.value.toUpperCase()"
          required
          aria-describedby="usernameHelp usernameStatus"
        >
      </div>

      <button class="btn primary btn-lg btn-block" id="submitBtn" disabled>
        <span class="btn-label">Enter</span>
        <span class="btn-spinner" aria-hidden="true"></span>
      </button>

      <p id="usernameHelp" class="hint">Allowed user (for now): <code>JMH</code></p>
      <p id="usernameStatus" class="small muted" role="status" aria-live="polite"></p>
    </form>
  </div>
</section>

<script>
  (function () {
    const input = document.getElementById('username');
    const form = document.getElementById('loginForm');
    const btn = document.getElementById('submitBtn');
    const status = document.getElementById('usernameStatus');

    // Autofocus when the page is interactive
    window.addEventListener('DOMContentLoaded', () => {
      try { input.focus(); } catch (e) {}
      validate();
    });

    function validate() {
      const v = (input.value || '').trim().toUpperCase();
      const ok = /^[A-Z]{3}$/.test(v);
      btn.disabled = !ok;
      status.textContent = ok ? '' : 'Username must be exactly 3 letters.';
    }

    input.addEventListener('input', validate);

    form.addEventListener('submit', () => {
      // Lock UI briefly for nicer feedback on submit
      btn.classList.add('loading');
      btn.disabled = true;
    });
  })();
</script>
{% endblock %}
